{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/registerSelect.js","webpack:///./src/js/dialog.art","webpack:///./node_modules/_art-template@4.13.2@art-template/lib/runtime.js","webpack:///./node_modules/_art-template@4.13.2@art-template/lib/compile/runtime.js","webpack:///(webpack)/buildin/global.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","render","translationTriangle","detailIframe","selectionTimer","selectString","yujingString","yujingId","fanyiString","fanyiProjectId","fanyiExtraData","fanyiMarkSource","soundTimer","soundIcon","range","contentWrap","shadowRoot","translationWrap","isDialogShow","chrome","runtime","sendMessage","type","cssText","document","addEventListener","event","clearTimeout","setTimeout","contains","target","selection","window","getSelection","rangeCount","tempSelectString","getRangeAt","toString","replace","toLowerCase","length","test","anchorNode","nodeType","className","parentNode","getAttribute","JSON","parse","e","console","error","innerText","substr","getElementById","createElement","id","style","translationContent","top","bottom","attachShadow","innerHTML","appendChild","body","rect","left","windowWidth","documentElement","clientWidth","windowHeight","clientHeight","width","location","protocol","open","getBoundingClientRect","right","rightLeft","src","Date","height","select","onmouseout","btnElem","trim","en","zh","yujing","fanyi","projectId","source","result","postMessage","data","href","scrolling","preventDefault","onload","jsonData","title","detail","dialogTop","dialogHeight","offsetHeight","dialogWidth","offsetWidth","dialogLeft","marginLeft","hidepopup","hideElem","removeEventListener","button","onresize","onscroll","translationCallback","init","origin","index","timer","setInterval","clearInterval","$$out","$escape","$imports","$data","$each","$value","$index","join","global","globalThis","self","ESCAPE_REG","content","html","regexResult","exec","lastIndex","char","charCodeAt","substring","xmlEscape","stringify","callback","Array","isArray","len","_i","g","this","Function"],"mappings":"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","file":"registerSelect.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","import '../css/iframe.scss';\r\nconst render = require('./dialog.art');\r\nvar translationWrap = null,\r\n    translationTriangle,\r\n    detailIframe,\r\n    isDialogShow = false,\r\n    selectionTimer,\r\n    selectString,\r\n    yujingString,\r\n    yujingId,\r\n    fanyiString,\r\n    fanyiProjectId,\r\n    fanyiExtraData,\r\n    fanyiMarkSource,\r\n    soundTimer,\r\n    soundIcon,\r\n    hideTimer;\r\nvar range;\r\nvar contentWrap;\r\nvar shadowRoot;\r\nchrome.runtime.sendMessage({type:\"getCssText\"}, function(cssText){\r\n    init(cssText);\r\n    \r\n});\r\nfunction init(cssText){\r\n    document.addEventListener(\"selectionchange\", function (event) {\r\n        clearTimeout(selectionTimer);\r\n        selectionTimer = setTimeout(function(){\r\n            if (translationWrap && translationWrap.contains(event.target)) {\r\n                return;\r\n            }\r\n            var selection = window.getSelection();\r\n            if(selection.rangeCount === 0) return;\r\n            range = selection.getRangeAt(0);\r\n            var tempSelectString = range.toString().replace(/^\\s*|\\s*$/, '');\r\n            if (tempSelectString === '' && isDialogShow) {\r\n                return;// 如果翻译框正在显示, 选取变了, 而且变化后为空, 那么不做处理\r\n            }\r\n            selectString = tempSelectString.toLowerCase();\r\n            if (selectString === '' || selectString.length > 200 || /[\\u4e00-\\u9fa5]+/.test(selectString)) {\r\n                return;\r\n            }\r\n            // 尝试获取语境\r\n            var anchorNode = selection.anchorNode;\r\n            while ( (anchorNode.nodeType === 1 && /fanyinotme/.test(anchorNode.className) && anchorNode.parentNode)\r\n                || (anchorNode.nodeType !== 1 && anchorNode.parentNode)) {\r\n                anchorNode = anchorNode.parentNode;\r\n            }\r\n            yujingId = anchorNode.getAttribute('yujing-id')\r\n            fanyiString = anchorNode.getAttribute('fanyi-string')\r\n            fanyiProjectId = anchorNode.getAttribute('fanyi-projectid')\r\n            fanyiMarkSource = anchorNode.getAttribute('fanyi-mark-source')\r\n            fanyiExtraData = anchorNode.getAttribute('fanyi-extra-data')\r\n            if (!fanyiProjectId) {\r\n                fanyiProjectId = 'chajian';\r\n            }\r\n            if (fanyiExtraData) {\r\n                try {\r\n                    fanyiExtraData = JSON.parse(fanyiExtraData);\r\n                } catch (e) {\r\n                    console.error(e);\r\n                }\r\n            }\r\n            yujingString = anchorNode.getAttribute('yujing-string')\r\n            if (yujingString === null) {\r\n                yujingString = anchorNode.innerText.replace(/(^[^a-zA-z]+|[^a-zA-z]+$)/, '').substr(0 ,100);\r\n            }\r\n            if (fanyiMarkSource === null) {\r\n                fanyiMarkSource = 'chajian';\r\n            }\r\n            \r\n            //获取json\r\n            translationWrap = document.getElementById(\"mlifeTranslationWrap\");\r\n            if (!translationWrap) {\r\n                translationWrap = document.createElement(\"section\");\r\n                translationWrap.id = 'mlifeTranslationWrap';\r\n                translationWrap.style.cssText = 'position:fixed;top:-10000px;left:0;';\r\n                translationWrap.addEventListener(\"transitionend\",function(event){\r\n                    var translationContent = shadowRoot.getElementById(\"translation-content\");\r\n                    if(/show/.test(translationContent.className)) return ;\r\n                    translationWrap.style.top = \"-10000px\";\r\n                    translationWrap.style.bottom = \"auto\";\r\n                },false);\r\n\r\n                // 添加shadow 标签\r\n                shadowRoot = translationWrap.attachShadow({\r\n                    mode: 'open'\r\n                });\r\n\r\n                var style = document.createElement(\"style\");\r\n                style.innerHTML = cssText;\r\n                shadowRoot.appendChild(style);\r\n\r\n                contentWrap = document.createElement(\"div\");\r\n                shadowRoot.appendChild(contentWrap);\r\n\r\n                document.body.appendChild(translationWrap);\r\n\r\n                shadowRoot.addEventListener(\"click\",function(event){\r\n                    var rect,\r\n                        windowWidth = document.documentElement.clientWidth,\r\n                        windowHeight = document.documentElement.clientHeight,\r\n                        left,\r\n                        width=585;\r\n                    if(event.target.className==\"baidu-go-detail\"){\r\n                        if (location.protocol !== 'https:') {\r\n                            window.open(`https://translate.google.com/#view=home&op=translate&sl=en&tl=zh-CN&text=${selectString}`, '_blank');\r\n                            return;\r\n                        }\r\n                        rect = translationWrap.getBoundingClientRect();\r\n                        if(windowWidth-rect.right < rect.left){\r\n                            if(rect.left > 595){\r\n                                left = rect.left - 595;\r\n                            }else{\r\n                                left = 5;\r\n                                width = rect.left - 10;\r\n                            }\r\n                        } else {\r\n                            var rightLeft = windowWidth-rect.right;\r\n                            left = rect.right + 5;\r\n                            if(rightLeft < 595){\r\n                                width = rightLeft - 10;\r\n                            }\r\n                        }\r\n                        detailIframe.src = `https://fanyi.baidu.com?iframe=true&temp=${new Date() * 1}/#en/zh/${selectString}`;\r\n                        detailIframe.style.height = windowHeight - 40 +\"px\";\r\n                        detailIframe.style.width = width +\"px\";\r\n                        detailIframe.style.left = left +\"px\";\r\n                    }\r\n                    if(event.target.className==\"google-go-detail\"){\r\n                        window.open(`https://translate.google.com/#view=home&op=translate&sl=en&tl=zh-CN&text=${selectString}`, '_blank');\r\n                    }\r\n                    if(event.target.className==\"baidu-go-blank\"){\r\n                        window.open(`https://fanyi.baidu.com/#en/zh/${selectString}`, '_blank');\r\n                    }\r\n                },false);\r\n                //监听发音\r\n                shadowRoot.addEventListener(\"mouseover\",function(event){\r\n                    if(event.target.className == \"icon-pronounce\"){\r\n                        soundIcon = event.target;\r\n                        soundTimer = setTimeout(function(){\r\n                            chrome.runtime.sendMessage({select:selectString,type:\"sound\"});\r\n                        },200);\r\n                        //icon-pronounce\r\n                        soundIcon.onmouseout = function(event){\r\n                            clearTimeout(soundTimer);\r\n                        };\r\n                    }\r\n                });\r\n                //监听加入收藏\r\n                shadowRoot.addEventListener(\"click\",function(event){\r\n                    var btnElem = event.target;\r\n                    if(event.target.className == \"icon-note\" && event.target.innerHTML.trim()==\"收藏\"){\r\n                        chrome.runtime.sendMessage({\r\n                            en:selectString,\r\n                            zh:shadowRoot.getElementById(\"tianya_query_str\").innerText,\r\n                            yujing: yujingString,\r\n                            fanyi: fanyiString,\r\n                            yujingId: yujingId,\r\n                            projectId: fanyiProjectId,\r\n                            fanyiExtraData: fanyiExtraData,\r\n                            source: fanyiMarkSource,\r\n                            type:\"addnote\"\r\n                        }, function(result) {\r\n                            if (result) {\r\n                                window.postMessage({\r\n                                    type: 'addMarkAndReportPage',\r\n                                    data: result\r\n                                }, location.href);\r\n                                btnElem.innerHTML = \"已收藏\";\r\n                            } else {\r\n                                btnElem.innerHTML = \"收藏失败\";\r\n                            }\r\n                        });\r\n                    }\r\n                    // if(event.target.className == \"icon-note\"&&event.target.innerHTML.trim()==\"已收藏\"){\r\n                    //     chrome.runtime.sendMessage({en:selectString,id:event.target.getAttribute(\"id\"), type:\"delnote\"},function(){\r\n                    //         btnElem.innerHTML = \"收藏\";\r\n                    //     });\r\n                    // }\r\n                    //监听加入收藏\r\n                });\r\n                \r\n                //创建详细的iframe\r\n                detailIframe = document.createElement(\"iframe\");\r\n                detailIframe.id = \"translationDetailIframe\";\r\n                detailIframe.scrolling = \"yes\";\r\n\r\n                //滚轮事件\r\n                detailIframe.addEventListener(\"mousewheel\", function(event){\r\n                    event.preventDefault();\r\n                },false);\r\n                //动画事件\r\n                detailIframe.addEventListener(\"transitionend\",function(event){\r\n                    if(/show/.test(detailIframe.className)) return ;\r\n                    detailIframe.style.left = \"-10000px\";\r\n                },false);\r\n                //load事件\r\n                detailIframe.onload = function(){\r\n                    detailIframe.className = \"show\";\r\n                }\r\n\r\n                document.body.appendChild(detailIframe);\r\n            }\r\n\r\n            //获取翻译结果并渲染\r\n            chrome.runtime.sendMessage({\r\n                select : selectString,\r\n                type : \"getTranslation\"\r\n            }, function (jsonData) {\r\n                translationCallback(jsonData);\r\n            });\r\n        }, 500)\r\n    }, false);\r\n}\r\nfunction translationCallback(jsonData) {\r\n    contentWrap.innerHTML = render({\r\n        data: jsonData,\r\n        title: jsonData[0],\r\n        detail: jsonData[1],\r\n    });\r\n    translationTriangle = shadowRoot.getElementById(\"translation-triangle\");\r\n    var translationContent = shadowRoot.getElementById(\"translation-content\");\r\n    //计算弹出框的高度,宽度\r\n    var dialogHeight = translationWrap.offsetHeight,\r\n        dialogWidth = translationWrap.offsetWidth,\r\n        rect = range.getBoundingClientRect(),\r\n        pointerLeft = rect.left + (rect.right - rect.left) / 2,\r\n        dialogLeft = pointerLeft - dialogWidth / 2,\r\n        windowHeight = document.documentElement.clientHeight,\r\n        windowWidth = document.documentElement.clientWidth,\r\n        dialogTop;\r\n    const topDiff = 30;\r\n    //设置left\r\n    if (dialogLeft < 0) {\r\n        translationTriangle.style.marginLeft = dialogLeft - 10 + \"px\";\r\n        dialogLeft = 0;\r\n    } else if (windowWidth - dialogLeft < dialogWidth) {\r\n        translationTriangle.style.marginLeft = -10 + dialogWidth - windowWidth + dialogLeft + \"px\";\r\n        dialogLeft = windowWidth - dialogWidth;\r\n    } else {\r\n        translationTriangle.style.marginLeft = \"-10px\";\r\n    }\r\n    translationWrap.style.left = dialogLeft + \"px\";\r\n    //设置top\r\n    //console.log(windowHeight , rect.bottom , dialogHeight);\r\n    // 修改: 之前是优先弹到下方, 改为优先弹到上方\r\n    if (rect.top - dialogHeight - 10 > 0) {\r\n        translationContent.className = \"translation-wrap show triangle-bottom\";\r\n        dialogTop = rect.top - 10;\r\n        translationWrap.style.top = \"auto\";\r\n        translationWrap.style.bottom = windowHeight - dialogTop + \"px\";\r\n    } else {\r\n        translationContent.className = \"translation-wrap show triangle-top\"\r\n        dialogTop = rect.bottom + 10;\r\n        translationWrap.style.bottom = \"auto\";\r\n        translationWrap.style.top = dialogTop + \"px\";\r\n    }\r\n    isDialogShow = true;\r\n    /*检测是否已经收藏*/\r\n    // chrome.runtime.sendMessage({\r\n    //     select : selectString,\r\n    //     type : \"checknote\"\r\n    // }, function (jsonData) {\r\n    //     if(jsonData.status==1){\r\n    //         shadowRoot.getElementById(\"tianya_note_btn\").innerHTML = \"已收藏\";\r\n    //         shadowRoot.getElementById(\"tianya_note_btn\").setAttribute(\"id\", jsonData.id);\r\n    //     }\r\n    // });\r\n    var hidepopup;\r\n    document.documentElement.addEventListener('mousedown', hidepopup = function(event) {\r\n        if(event.button == 2) return;\r\n        if (!translationWrap.contains(event.target)) {\r\n            hideElem();\r\n        }\r\n    }, false);\r\n    window.onresize = function () {\r\n        hideElem();\r\n    }\r\n    window.onscroll = function () {\r\n        hideElem();\r\n    }\r\n    function hideElem() {\r\n        isDialogShow = false;\r\n        document.documentElement.removeEventListener('mousedown', hidepopup);\r\n        translationContent.className = \"translation-wrap\";\r\n        translationWrap.style.left = \"-3000px\";\r\n        detailIframe.className = \"\";\r\n    }\r\n}\r\nfunction loadTemplate(template) {\r\n    var funcstr = template.toString(),\r\n        reg = /\\/\\*loadText\\*([\\s\\S]+?)\\*\\//gm,\r\n        reg_result = reg.exec(funcstr);\r\n    if (reg_result !== null) {\r\n        return reg_result[1];\r\n    }\r\n    return null;\r\n}\r\nif (location.origin === baseUrl) {\r\n    let index = 0;\r\n    let timer = null;\r\n    const mf = () => {\r\n        index++;\r\n        if (index > 10) {\r\n            clearInterval(timer);\r\n        }\r\n        window.postMessage({\r\n            type: 'userBrowserHasInstallExtension'\r\n        });\r\n    }\r\n    timer = setInterval(mf, 2000);\r\n}","{{if detail !== null}}\n    <section class=\"translation-wrap\" id=\"translation-content\">\n        <span class=\"triangle\" id=\"translation-triangle\"></span>\n        <header class=\"translation-header\">\n            <i class=\"icon\"></i><span>翻译</span>\n        </header>\n        <div class=\"translation-content\">\n            <h3>\n                <div class=\"title1\">\n                    <span class=\"transition-word\" id=\"tianya_query_str\">{{title[0][0]}}</span>\n                    <i class=\"icon-note\" id=\"tianya_note_btn\">收藏</i>\n                    <span class=\"baidu-go-detail\">详细</span>\n                    <span class=\"google-go-detail\">Google新窗口</span>\n                    <span class=\"baidu-go-blank\">百度新窗口</span>\n                </div>\n                <div class=\"pronounce\"><span>[{{title[1][3]}}]</span> <i class=\"icon-pronounce\"></i></div>\n            </h3>\n            <ul class=\"explain\" id=\"tianya_response_str\">\n                {{title[0][0]}}\n            </ul>\n            <h3 class=\"web-title\">\n                <span class=\"title\">来自Google</span>\n            </h3>\n            <dl class=\"web-explain-list\">\n                {{each detail}}\n                    <dt class=\"web-explain-title\">{{$value[0]}}</dt>\n                    <dd class=\"web-explain-detail\">{{$value[1].join(\" | \")}}</dd>\n                {{/each}}\n            </dl>\n        </div>\n    </section>\n    {{else}}\n    <section class=\"translation-wrap\" id=\"translation-content\">\n        <span class=\"triangle\" id=\"translation-triangle\"></span>\n        <header class=\"translation-header\">\n            <i class=\"icon\"></i><span>翻译</span>\n        </header>\n        <div class=\"translation-content sentence\">\n            <h3 class=\"web-title\">\n                <span class=\"title\">来自Google</span>\n            </h3>\n            <div class=\"detail\" id=\"tianya_response_str\">\n                <span class=\"transition-word\" id=\"tianya_query_str\">{{title[0][0]}}</span>\n            </div>\n            <h3 class=\"h3title\">\n                <i class=\"icon-pronounce\"></i>\n                <i class=\"icon-note\" id=\"tianya_note_btn\">收藏</i>\n                <span class=\"baidu-go-detail\">详细</span>\n                <span class=\"google-go-detail\">Google新窗口</span>\n                <span class=\"baidu-go-blank\">百度新窗口</span>\n            </h3>\n        </div>\n    </section>\n{{/if}}","'use strict';\n\nmodule.exports = require('./compile/runtime');","'use strict';\n\n/*! art-template@runtime | https://github.com/aui/art-template */\n\nvar globalThis = typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : {};\n\nvar runtime = Object.create(globalThis);\nvar ESCAPE_REG = /[\"&'<>]/;\n\n/**\n * 编码模板输出的内容\n * @param  {any}        content\n * @return {string}\n */\nruntime.$escape = function (content) {\n    return xmlEscape(toString(content));\n};\n\n/**\n * 迭代器，支持数组与对象\n * @param {array|Object} data\n * @param {function}     callback\n */\nruntime.$each = function (data, callback) {\n    if (Array.isArray(data)) {\n        for (var i = 0, len = data.length; i < len; i++) {\n            callback(data[i], i);\n        }\n    } else {\n        for (var _i in data) {\n            callback(data[_i], _i);\n        }\n    }\n};\n\n// 将目标转成字符\nfunction toString(value) {\n    if (typeof value !== 'string') {\n        if (value === undefined || value === null) {\n            value = '';\n        } else if (typeof value === 'function') {\n            value = toString(value.call(value));\n        } else {\n            value = JSON.stringify(value);\n        }\n    }\n\n    return value;\n}\n\n// 编码 HTML 内容\nfunction xmlEscape(content) {\n    var html = '' + content;\n    var regexResult = ESCAPE_REG.exec(html);\n    if (!regexResult) {\n        return content;\n    }\n\n    var result = '';\n    var i = void 0,\n        lastIndex = void 0,\n        char = void 0;\n    for (i = regexResult.index, lastIndex = 0; i < html.length; i++) {\n        switch (html.charCodeAt(i)) {\n            case 34:\n                char = '&#34;';\n                break;\n            case 38:\n                char = '&#38;';\n                break;\n            case 39:\n                char = '&#39;';\n                break;\n            case 60:\n                char = '&#60;';\n                break;\n            case 62:\n                char = '&#62;';\n                break;\n            default:\n                continue;\n        }\n\n        if (lastIndex !== i) {\n            result += html.substring(lastIndex, i);\n        }\n\n        lastIndex = i + 1;\n        result += char;\n    }\n\n    if (lastIndex !== i) {\n        return result + html.substring(lastIndex, i);\n    } else {\n        return result;\n    }\n}\n\nmodule.exports = runtime;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}